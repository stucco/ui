<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">
<polymer-element name="detail-component" attributes="vertexDetails edgeDetails nextVertexId vProps">
     <template>
        <!-- <template if="{{vertexDetails['_id']}}">
    	   <b>ID: </b> {{vertexDetails["_id"]}}
        </template> -->
        <template if="{{vertexDetails['name']}}">
           <p>
                <b>Name: </b> {{vertexDetails["name"]}}
            </p>
        </template>
        <template repeat="{{property in vProps}}">
            <template if="{{vertexDetails[property]}}">
                <p>
                    <b>{{property}}: </b> {{vertexDetails[property]}}
                </p>
            </template>
        </template>
        <b>Edges:</b>
        <paper-spinner id="spinner"></paper-spinner>
        <template if="{{edgeDetails}}">
            <table id="edgeTable" class="edgeTable">
            	<tr class="edgeTableRow">
            		<td> Relationship </td>
            		<td> Name </td>
            		<td> Type </td>
            		<td> Source </td>
            	</tr>
                <template repeat="{{edge, index in edgeDetails}}">
                    <tr id="{{index}}" on-click="{{goToNextVertex}}" on-mouseover="{{highlightRow}}" on-mouseout="{{unHighlightRow}}" class="edgeTableRow">
                        <td> {{edge["label"]}} </td>
                        <td> {{edge["name"]}} </td>
                        <td> {{edge["vertexType"]}} </td>
                        <td> {{edge["source"]}} </td>
                    </tr>
                </template>
            </table>
        </template>
    </template>
    <script>
        Polymer('detail-component', {
        	vertexDetails : {},
            edgeDetails : [],
            vProps : [],
            nextVertexId : "",
            vertexDetailsChanged : function() {
            	if (this.vertexDetails["_id"]) {
            		this.nextVertexId = "";
            		this.$.spinner.active = true;
            	}
            },
            goToNextVertex : function (event, detail, sender) {
                var selectedEdge = this.edgeDetails[sender.id];
                this.nextVertexId = selectedEdge["_id"];
                this.$.edgeDetails.hidden = true;
                this.$.spinner.active = true;
            },
            edgeDetailsChanged : function() {
                if (this.edgeDetails.length > 0) {
                    this.$.edgeTable.hidden = false;
                    this.$.spinner.active = false;
                }
            },
            highlightRow : function(event, detail, sender) {
                sender.style.backgroundColor = '#F3F781';
            },
            unHighlightRow : function(event, detail, sender) {
                sender.style.backgroundColor = 'white';
            }
       });
    </script>
</polymer-element>